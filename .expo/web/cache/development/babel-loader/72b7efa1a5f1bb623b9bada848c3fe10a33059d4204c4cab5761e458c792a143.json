{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components/native\";\nimport Constants from \"expo-constants\";\nimport Icon from \"@expo/vector-icons/Ionicons\";\nimport ComentariosContainer from \"./comentarioContainer\";\nimport { getCurrentDate } from \"../../utils/time\";\nimport { Nav } from \"./Nav\";\nimport SockJS from \"sockjs-client\";\nimport Stomp from \"stompjs\";\nimport { getComentarios } from \"../../utils/getComentarios\";\nimport { sendComentario, updateComentario } from \"./WSComentario\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar TodosComentarios = function TodosComentarios(_ref) {\n  var navigation = _ref.navigation,\n    route = _ref.route;\n  var publicacao = route.params.publicacao;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    message = _useState2[0],\n    setMessage = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    comentarios = _useState4[0],\n    setComentarios = _useState4[1];\n  var _useState5 = useState(true),\n    _useState6 = _slicedToArray(_useState5, 2),\n    loading = _useState6[0],\n    setLoading = _useState6[1];\n  var webSock = useRef(null);\n  useEffect(function () {\n    getComentarios({\n      publicacao: publicacao,\n      setComentarios: setComentarios,\n      setLoading: setLoading\n    });\n    var sock = new SockJS(\"http://10.0.0.181:8080/ws\");\n    var stompClient = Stomp.over(sock);\n    webSock.current = stompClient;\n    webSock.current.connect({}, function (frame) {\n      var _webSock$current;\n      (_webSock$current = webSock.current) == null ? void 0 : _webSock$current.subscribe(\"/topic/public/\" + publicacao.getId(), function (message) {\n        updateComentario({\n          id: comentarios.length + 1,\n          message: message,\n          setComentarios: setComentarios\n        });\n      });\n    });\n    return function () {\n      if (webSock.current) {\n        webSock.current.disconnect(function () {\n          console.log(\"Desconectado.\");\n        });\n      }\n    };\n  }, []);\n  var enviar = function enviar() {\n    if (message.length > 0) {\n      sendComentario({\n        webSock: webSock,\n        publicacao: publicacao,\n        message: message,\n        setMessage: setMessage\n      });\n    }\n  };\n  return _jsxs(Container, {\n    children: [_jsx(Nav, {}), _jsxs(ScrollViewContainer, {\n      children: [_jsxs(ContainerPublicacao, {\n        children: [_jsxs(ContainerUsuario, {\n          children: [_jsx(TouchUserName, {\n            onPress: function onPress() {\n              return navigation.navigate(\"ChatScreen\", {\n                idRemetente: publicacao.getUsuario().getId(),\n                nome: publicacao.getUsuario().getApelido()\n              });\n            },\n            children: _jsxs(NomeUsuario, {\n              children: [\"@\", publicacao.getUsuario().getApelido()]\n            })\n          }), _jsx(TempoPublicacao, {\n            children: getCurrentDate(publicacao.getDate())\n          })]\n        }), _jsx(Publicacao, {\n          children: publicacao.getPublicacao()\n        })]\n      }), _jsx(ComentarioContainer, {\n        children: _jsx(ComentariosContainer, {\n          loading: loading,\n          id: publicacao.getId(),\n          comentarios: comentarios,\n          setComentarios: setComentarios\n        })\n      })]\n    }), _jsxs(EscreverComentario, {\n      children: [_jsx(Input, {\n        placeholder: \"Escreva uma mensagem...\",\n        placeholderTextColor: \"white\",\n        onChangeText: function onChangeText(text) {\n          return setMessage(text);\n        },\n        value: message,\n        cursorColor: \"white\",\n        multiline: true\n      }), _jsx(BotaoEnviar, {\n        onPress: function onPress() {\n          return enviar();\n        },\n        children: _jsx(Icon, {\n          name: \"send\",\n          color: \"green\",\n          size: 24\n        })\n      })]\n    })]\n  });\n};\nexport default TodosComentarios;\nvar Container = styled.SafeAreaView`\n    flex: 1;\n    margin-top: ${Constants.statusBarHeight}px;\n    background-color: #303030;\n`;\nvar ContainerPublicacao = styled.View`\n    min-height: 140px;\n    width: 100%;\n    background-color: #136075;\n    padding-horizontal: 10px;\n    padding-vertical: 20px;\n`;\nvar NomeUsuario = styled.Text`\n    font-size: 16px;\n    color: white;\n    font-weight: 500;\n`;\nvar TempoPublicacao = styled.Text`\n    font-size: 11px;\n    color: white;\n`;\nvar ContainerUsuario = styled.View`\n    width: 70%;\n    height: 60px;\n    flex-direction: column;\n`;\nvar Publicacao = styled.Text`\n    width: 100%;\n    min-height: 10px;\n    color: white;\n`;\nvar ComentarioContainer = styled.View`\n    flex: 1;\n    background-color: #303030;\n`;\nvar EscreverComentario = styled.View`\n    position: absolute;\n    z-index: 2;\n    background-color: #303030;\n    width: 100%;\n    min-height: 50px;\n    max-height: 130px;\n    bottom: 0px;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    border-top-width: 1px;\n    border-top-color: white;\n`;\nvar Input = styled.TextInput`\n    width: 90%;\n    min-height: 46px;\n    max-height: 126px;\n    color: white;\n    font-size: 16px;\n    padding-horizontal: 2px;\n    padding-vertical: 6px;\n`;\nvar BotaoEnviar = styled.TouchableOpacity`\n    justify-content: center;\n    align-items: center;\n    height: 46px;\n    width: 10%;\n`;\nvar ScrollViewContainer = styled.ScrollView`\n    flex: 1;\n`;\nvar TouchUserName = styled.TouchableOpacity`\n`;","map":{"version":3,"names":["React","useEffect","useRef","useState","styled","Constants","Icon","ComentariosContainer","getCurrentDate","Nav","SockJS","Stomp","getComentarios","sendComentario","updateComentario","jsx","_jsx","jsxs","_jsxs","TodosComentarios","_ref","navigation","route","publicacao","params","_useState","_useState2","_slicedToArray","message","setMessage","_useState3","_useState4","comentarios","setComentarios","_useState5","_useState6","loading","setLoading","webSock","sock","stompClient","over","current","connect","frame","_webSock$current","subscribe","getId","id","length","disconnect","console","log","enviar","Container","children","ScrollViewContainer","ContainerPublicacao","ContainerUsuario","TouchUserName","onPress","navigate","idRemetente","getUsuario","nome","getApelido","NomeUsuario","TempoPublicacao","getDate","Publicacao","getPublicacao","ComentarioContainer","EscreverComentario","Input","placeholder","placeholderTextColor","onChangeText","text","value","cursorColor","multiline","BotaoEnviar","name","color","size","SafeAreaView","statusBarHeight","View","Text","TextInput","TouchableOpacity","ScrollView"],"sources":["/home/marcos_anderson/MeusProjetos/FriedZone/friendzoneapp/components/comentario/index.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport styled from \"styled-components/native\";\nimport Constants from \"expo-constants\";\nimport Icon from \"react-native-vector-icons/Ionicons\";\nimport ComentariosContainer from \"./comentarioContainer\";\nimport { ComentarioProps } from \"../../utils/interfaces\";\nimport { getCurrentDate } from \"../../utils/time\";\nimport { Comentario } from \"../../model/Comentario\";\nimport { Nav } from \"./Nav\";\nimport SockJS from \"sockjs-client\";\nimport Stomp, { Client } from \"stompjs\";\nimport { getComentarios } from \"../../utils/getComentarios\";\nimport { sendComentario, updateComentario } from \"./WSComentario\";\n\nconst TodosComentarios: React.FC<ComentarioProps> = ({ navigation, route }) => {\n    const { publicacao } = route.params;\n    const [message, setMessage] = useState<string>('');\n    const [comentarios, setComentarios] = useState<Comentario[]>([]);\n    const [loading, setLoading] = useState<boolean>(true);\n    const webSock = useRef<Client | null>(null);\n\n    useEffect(() => {\n        getComentarios({ publicacao, setComentarios, setLoading });\n        var sock = new SockJS(\"http://10.0.0.181:8080/ws\");\n        let stompClient: Client = Stomp.over(sock);\n        webSock.current = stompClient;\n\n        webSock.current.connect({}, function (frame) {\n            webSock.current?.subscribe(\"/topic/public/\" + publicacao.getId(), function (message) {\n                updateComentario({ id: comentarios.length + 1, message, setComentarios });\n            });\n        });\n\n        return () => {\n            if (webSock.current) {\n                webSock.current.disconnect(() => {console.log(\"Desconectado.\")});\n            }\n        };\n    }, []);\n\n    const enviar = () => {\n        if (message.length > 0) {\n            sendComentario({webSock, publicacao, message, setMessage});\n        }\n    };\n    \n    return (\n        <Container>\n            <Nav></Nav>\n            <ScrollViewContainer>\n                <ContainerPublicacao>\n                    <ContainerUsuario>\n                        <TouchUserName onPress={() => navigation.navigate(\"ChatScreen\", { idRemetente: publicacao.getUsuario().getId(), nome: publicacao.getUsuario().getApelido() })}>\n                            <NomeUsuario>@{publicacao.getUsuario().getApelido()}</NomeUsuario>\n                        </TouchUserName>\n                        <TempoPublicacao>{getCurrentDate(publicacao.getDate())}</TempoPublicacao>  \n                    </ContainerUsuario>\n                    <Publicacao>{publicacao.getPublicacao()}</Publicacao>\n                </ContainerPublicacao>\n                <ComentarioContainer>\n                    <ComentariosContainer \n                    loading={loading}\n                    id={publicacao.getId()} \n                    comentarios={comentarios}\n                    setComentarios={setComentarios}\n                    />\n                </ComentarioContainer>\n            </ScrollViewContainer>\n            <EscreverComentario>\n                <Input \n                placeholder=\"Escreva uma mensagem...\" \n                placeholderTextColor={\"white\"} \n                onChangeText={(text) => setMessage(text)}\n                value={message}\n                cursorColor={\"white\"} \n                multiline={true}></Input>\n                <BotaoEnviar onPress={() => enviar()}>\n                    <Icon name={\"send\"} color={\"green\"} size={24}/>\n                </BotaoEnviar>\n            </EscreverComentario>\n        </Container>\n    )\n}\n\nexport default TodosComentarios;\n\nconst Container = styled.SafeAreaView`\n    flex: 1;\n    margin-top: ${Constants.statusBarHeight}px;\n    background-color: #303030;\n`\n\nconst ContainerPublicacao = styled.View`\n    min-height: 140px;\n    width: 100%;\n    background-color: #136075;\n    padding-horizontal: 10px;\n    padding-vertical: 20px;\n`\n\nconst NomeUsuario = styled.Text`\n    font-size: 16px;\n    color: white;\n    font-weight: 500;\n`\n\nconst TempoPublicacao = styled.Text`\n    font-size: 11px;\n    color: white;\n`\nconst ContainerUsuario = styled.View`\n    width: 70%;\n    height: 60px;\n    flex-direction: column;\n`\n\nconst Publicacao = styled.Text`\n    width: 100%;\n    min-height: 10px;\n    color: white;\n`\n\nconst ComentarioContainer = styled.View`\n    flex: 1;\n    background-color: #303030;\n`\nconst EscreverComentario = styled.View`\n    position: absolute;\n    z-index: 2;\n    background-color: #303030;\n    width: 100%;\n    min-height: 50px;\n    max-height: 130px;\n    bottom: 0px;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    border-top-width: 1px;\n    border-top-color: white;\n`\n\nconst Input = styled.TextInput`\n    width: 90%;\n    min-height: 46px;\n    max-height: 126px;\n    color: white;\n    font-size: 16px;\n    padding-horizontal: 2px;\n    padding-vertical: 6px;\n`\n\nconst BotaoEnviar = styled.TouchableOpacity`\n    justify-content: center;\n    align-items: center;\n    height: 46px;\n    width: 10%;\n`\n\nconst ScrollViewContainer = styled.ScrollView`\n    flex: 1;\n`\n\nconst TouchUserName = styled.TouchableOpacity`\n`"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}