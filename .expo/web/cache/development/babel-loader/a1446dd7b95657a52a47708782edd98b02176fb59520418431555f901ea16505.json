{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport { Comentario } from \"../../model/Comentario\";\nvar WebSocketTSX = function () {\n  function WebSocketTSX(server) {\n    _classCallCheck(this, WebSocketTSX);\n    this.webSocket = new WebSocket(server);\n  }\n  _createClass(WebSocketTSX, [{\n    key: \"openSocket\",\n    value: function openSocket() {\n      var _this = this;\n      return new Promise(function (resolve, reject) {\n        _this.webSocket.onopen = function () {\n          console.log(\"Conectado ao WebSocket.\");\n          resolve();\n        };\n        _this.webSocket.onerror = function (err) {\n          console.error(\"Erro ao conectar ao WebSocket:\", err);\n          reject(err);\n        };\n      });\n    }\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(callback) {\n      this.webSocket.onmessage = function (e) {\n        try {\n          var data = JSON.parse(e.data);\n          console.log(data);\n          var newComentario = Comentario.builder().withComentario(data.comentario).withId(data.id ? data.id : null).withUsuario(data.usuario ? data.usuario.apelido : \"Usuario Teste\").build();\n          callback(newComentario);\n        } catch (error) {\n          console.error(\"Erro ao processar mensagem WebSocket:\", error);\n        }\n      };\n    }\n  }, {\n    key: \"onClose\",\n    value: function onClose() {\n      this.webSocket.onclose = function (e) {\n        console.log(\"Conexão fechada\", e.code, e.reason);\n      };\n    }\n  }, {\n    key: \"onSend\",\n    value: function onSend(destination, message) {\n      var _this2 = this;\n      var messageJSON = {\n        comentario: message,\n        codigoAcesso: 12345,\n        idPublicacao: 1,\n        idUsuajjrio: 1\n      };\n      var stringData = JSON.stringify(messageJSON);\n      return new Promise(function (resolve, reject) {\n        try {\n          _this2.webSocket.send(stringData);\n          console.log('Mensagem enviada com sucesso.');\n          resolve();\n        } catch (error) {\n          console.error('Erro ao enviar mensagem:', error);\n          reject(error);\n        }\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.webSocket.close();\n    }\n  }, {\n    key: \"onError\",\n    value: function onError() {\n      this.webSocket.onerror = function (e) {\n        console.error(\"Erro no WebSocket:\", e);\n      };\n    }\n  }, {\n    key: \"onReconnect\",\n    value: function onReconnect() {\n      var _this3 = this;\n      setInterval(function () {\n        if (_this3.webSocket.readyState !== WebSocket.OPEN) {\n          console.log(\"Tentando reconectar...\");\n          _this3.openSocket();\n        }\n      }, 5000);\n    }\n  }]);\n  return WebSocketTSX;\n}();\nexport default WebSocketTSX;","map":{"version":3,"names":["Comentario","WebSocketTSX","server","_classCallCheck","webSocket","WebSocket","_createClass","key","value","openSocket","_this","Promise","resolve","reject","onopen","console","log","onerror","err","error","onMessage","callback","onmessage","e","data","JSON","parse","newComentario","builder","withComentario","comentario","withId","id","withUsuario","usuario","apelido","build","onClose","onclose","code","reason","onSend","destination","message","_this2","messageJSON","codigoAcesso","idPublicacao","idUsuajjrio","stringData","stringify","send","close","onError","onReconnect","_this3","setInterval","readyState","OPEN"],"sources":["/home/marcos_anderson/MeusProjetos/FriedZone/friendzoneapp/components/comentario/WebSocketTSX.tsx"],"sourcesContent":["import { Comentario } from \"../../model/Comentario\";\n\nclass WebSocketTSX {\n    private webSocket: WebSocket;\n\n    constructor(server: string) {\n        this.webSocket = new WebSocket(server);\n    }\n\n    openSocket(): Promise<void> {\n        return new Promise((resolve, reject) => {\n            this.webSocket.onopen = () => {\n                console.log(\"Conectado ao WebSocket.\");\n                resolve();\n            };\n            this.webSocket.onerror = (err) => {\n                console.error(\"Erro ao conectar ao WebSocket:\", err);\n                reject(err);\n            };\n        });\n    }\n\n    onMessage(callback: (comentario: Comentario) => void): void {\n        this.webSocket.onmessage = (e) => {\n            try {\n                const data = JSON.parse(e.data);\n                console.log(data);\n    \n                const newComentario = Comentario.builder()\n                    .withComentario(data.comentario)\n                    .withId(data.id ? data.id : null)\n                    .withUsuario(data.usuario ? data.usuario.apelido : \"Usuario Teste\")\n                    .build();\n    \n                callback(newComentario);\n            } catch (error) {\n                console.error(\"Erro ao processar mensagem WebSocket:\", error);\n            }\n        };\n    }\n\n    onClose(): void {\n        this.webSocket.onclose = (e) => {\n            console.log(\"Conexão fechada\", e.code, e.reason);\n        }\n    }\n\n    onSend(destination: string, message: string): Promise<void> {\n        const messageJSON = {\n            comentario: message,\n            codigoAcesso: 12345,\n            idPublicacao: 1,\n            idUsuajjrio: 1\n        };\n        const stringData: string = JSON.stringify(messageJSON);\n\n        return new Promise((resolve, reject) => {\n            try {\n                this.webSocket.send(stringData);\n                console.log('Mensagem enviada com sucesso.');\n                resolve();\n            } catch (error) {\n                console.error('Erro ao enviar mensagem:', error);\n                reject(error);\n            }\n        });\n    }\n    \n    close(): void {\n        this.webSocket.close();\n    }\n\n    onError(): void {\n        this.webSocket.onerror = (e) => {\n            console.error(\"Erro no WebSocket:\", e);\n        }\n    }\n\n    onReconnect(): void {\n        setInterval(() => {\n            if (this.webSocket.readyState !== WebSocket.OPEN) {\n                console.log(\"Tentando reconectar...\");\n                this.openSocket();\n            }\n        }, 5000);\n    }\n}\n\nexport default WebSocketTSX;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}